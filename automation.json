{
  "devicesEndpoint": "/api/extensions/roku-integration/devices",
  "triggers": [
    {
      "key": "state",
      "label": "Roku power state changed",
      "description": "When a Roku device turns on, off, starts playing, or goes idle",
      "fields": [
        {"key": "entity_id", "type": "device", "label": "Roku Device"},
        {"key": "to", "type": "select", "label": "New State", "options": [
          {"value": "on", "label": "On (home screen)"},
          {"value": "off", "label": "Off (standby)"},
          {"value": "playing", "label": "Playing (app active)"},
          {"value": "idle", "label": "Idle (screensaver)"}
        ]},
        {"key": "from", "type": "select", "label": "Previous State (optional)", "options": [
          {"value": "on", "label": "On (home screen)"},
          {"value": "off", "label": "Off (standby)"},
          {"value": "playing", "label": "Playing (app active)"},
          {"value": "idle", "label": "Idle (screensaver)"}
        ]}
      ],
      "output": ["entity_id", "old_state", "new_state", "attributes"]
    },
    {
      "key": "state",
      "label": "Roku started playing",
      "description": "When a Roku device launches an app or starts playing content",
      "fields": [
        {"key": "entity_id", "type": "device", "label": "Roku Device"},
        {"key": "to", "type": "hidden", "value": "playing"}
      ],
      "output": ["entity_id", "old_state", "new_state", "attributes"]
    },
    {
      "key": "state",
      "label": "Roku turned on",
      "description": "When a Roku device wakes from standby",
      "fields": [
        {"key": "entity_id", "type": "device", "label": "Roku Device"},
        {"key": "from", "type": "hidden", "value": "off"},
        {"key": "to", "type": "hidden", "value": "on"}
      ],
      "output": ["entity_id", "old_state", "new_state", "attributes"]
    },
    {
      "key": "state",
      "label": "Roku turned off",
      "description": "When a Roku device goes to standby",
      "fields": [
        {"key": "entity_id", "type": "device", "label": "Roku Device"},
        {"key": "to", "type": "hidden", "value": "off"}
      ],
      "output": ["entity_id", "old_state", "new_state", "attributes"]
    }
  ],
  "actions": [
    {
      "key": "power_on",
      "label": "Power on Roku",
      "description": "Wake up a Roku device from standby",
      "endpoint": "POST /api/extensions/roku-integration/devices/{{device_id}}/power/on",
      "fields": [
        {"key": "device_id", "type": "device", "label": "Roku Device", "required": true}
      ]
    },
    {
      "key": "power_off",
      "label": "Power off Roku",
      "description": "Put a Roku device into standby",
      "endpoint": "POST /api/extensions/roku-integration/devices/{{device_id}}/power/off",
      "fields": [
        {"key": "device_id", "type": "device", "label": "Roku Device", "required": true}
      ]
    },
    {
      "key": "launch_app",
      "label": "Launch app on Roku",
      "description": "Launch an app on a Roku device",
      "endpoint": "POST /api/extensions/roku-integration/devices/{{device_id}}/launch/{{app_id}}",
      "fields": [
        {"key": "device_id", "type": "device", "label": "Roku Device", "required": true},
        {"key": "app_id", "type": "select", "label": "App", "required": true, "source": "/api/extensions/roku-integration/devices/{{device_id}}/apps"}
      ]
    },
    {
      "key": "send_keypress",
      "label": "Send Roku remote key",
      "description": "Send a remote control key press",
      "endpoint": "POST /api/extensions/roku-integration/devices/{{device_id}}/keypress/{{key}}",
      "fields": [
        {"key": "device_id", "type": "device", "label": "Roku Device", "required": true},
        {"key": "key", "type": "select", "label": "Key", "required": true, "options": [
          {"value": "Home", "label": "Home"},
          {"value": "Back", "label": "Back"},
          {"value": "Select", "label": "OK/Select"},
          {"value": "Up", "label": "Up"},
          {"value": "Down", "label": "Down"},
          {"value": "Left", "label": "Left"},
          {"value": "Right", "label": "Right"},
          {"value": "Play", "label": "Play"},
          {"value": "Pause", "label": "Pause"},
          {"value": "Rev", "label": "Rewind"},
          {"value": "Fwd", "label": "Fast Forward"},
          {"value": "VolumeUp", "label": "Volume Up"},
          {"value": "VolumeDown", "label": "Volume Down"},
          {"value": "VolumeMute", "label": "Mute"}
        ]}
      ]
    }
  ]
}
